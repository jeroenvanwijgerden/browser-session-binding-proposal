New protocol idea.

Browser generates a session id, but before showing it (to the user and an attacker) as QR, makes a `register` request to the server with its session id. If the server does not have a registered ceremony for that session id yet, it creates a ceremony for the session id and responds with a complete token. If there is already a registered ceremony for this session id, an accidental clash is reasonable to assume, as the session id could not be stolen yet; the server responds that the session id was a clash; the browser generates a new session id and tries again; should be bounded to let's say three registration attempts in total (even though a single clash is already extremely unlikely).

The complete token is a cryptographically secure secret between the server and browser. Only after succesful registration, the browser shows a QR code (containing the negotiate URL and the session ID), and UI elements to enter a post-negotiate code.

The app scans the QR code. The user, on the app, starts the negotiation between app and server. On success, the server stages the negotiated result to be retrieved shortly by the browser that did the initial registration of the ceremony (ensured by requiring the complete token for retrieval); the server responds to the app with a post-negotiate code. If an attacker managed to successfully negotiate for this session id (which in this protocol doubles as the ceremony id) BEFORE the user, then upon a negotiation attempt by the user the server responds with a 'negotiation already performed: fixation attack; your environment is compromised!'.

The user enters the post-negotiate code into the browser; the browser sends the session id, complete token and post-negotiate code to the `complete` endpoint, and if for the session there is a result staged, and the complete token matches, and the post-negotiate code matches, the server responds with the staged result.

Compared to the old protocol, the key difference is that in the new protocol it's the browser that initiates the ceremony, and does so before exposing the session id. This makes session hijacking immediately impossible (given that the complete token is a secure secret between server and browser, and that this is performed before the session id is made visible). The major upside of this is that one fewer manual step is needed (user no longer needs to enter a post-claim code). A downside is that now the server has start maintaining state before negotation, possibly making excessive memory consumption more prone to bots. 